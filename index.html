function addTask() {
    const form = document.getElementById("taskInputs");
    const index = form.children.length;

    const taskDiv = document.createElement("div");
    taskDiv.classList.add("task-container");
    taskDiv.setAttribute("id", `taskContainer${index}`);

    taskDiv.innerHTML = `
        <h3>Task ${index + 1}</h3>
        <label>Task Name:</label>
        <input type="text" class="task-input" id="task${index}" required>
        
        <label>Aligns with goal?
            <select id="goal${index}">
                <option value="2">Yes</option>
                <option value="1">No</option>
            </select>
        </label>

        <label>Consequence of not doing?
            <select id="consequence${index}">
                <option value="3">High</option>
                <option value="2">Medium</option>
                <option value="1">Low</option>
            </select>
        </label>

        <label>Best use of your time?
            <select id="time${index}">
                <option value="2">Yes</option>
                <option value="1">No</option>
            </select>
        </label>
        
        <label>Only you can do it?
            <select id="ownership${index}">
                <option value="2">Yes</option>
                <option value="1">No</option>
            </select>
        </label>
        
        <label>Can be automated?
            <select id="automation${index}">
                <option value="-1">Yes</option>
                <option value="0">No</option>
            </select>
        </label>
        
        <label>Due Date & Time:
            <input type="datetime-local" id="due${index}">
        </label>
        
        <label>How long will this task take? (Minutes)
            <input type="number" id="duration${index}" min="1">
        </label>
        
        <label>Best time to complete?
            <select id="bestTime${index}">
                <option value="Morning">Morning</option>
                <option value="Afternoon">Afternoon</option>
                <option value="Evening">Evening</option>
            </select>
        </label>
    `;
    form.appendChild(taskDiv);
}

function prioritizeTasks(event) {
    event.preventDefault();
    
    let tasks = [];
    let taskList = document.getElementById("taskList");
    taskList.innerHTML = "";
    document.getElementById("result").style.display = "block";

    document.querySelectorAll(".task-container").forEach((task, index) => {
        let name = task.querySelector(".task-input").value.trim();
        if (!name) return; // Prevent adding empty tasks

        let dueDate = task.querySelector(`#due${index}`).value;
        let goal = parseInt(task.querySelector(`#goal${index}`).value);
        let consequence = parseInt(task.querySelector(`#consequence${index}`).value);
        let time = parseInt(task.querySelector(`#time${index}`).value);
        let ownership = parseInt(task.querySelector(`#ownership${index}`).value);
        let automation = parseInt(task.querySelector(`#automation${index}`).value);
        let duration = parseInt(task.querySelector(`#duration${index}`).value) || 0;
        let bestTime = task.querySelector(`#bestTime${index}`).value;

        // Calculate priority score
        let priorityScore = goal + consequence + time + ownership + automation;

        tasks.push({ 
            name, dueDate, priorityScore, duration, bestTime, index, 
            automation, ownership 
        });
    });

    // Sort tasks by priority score (Descending order)
    tasks.sort((a, b) => b.priorityScore - a.priorityScore);

    // Display prioritized tasks
    tasks.forEach((task, index) => {
        let taskItem = document.createElement("li");
        taskItem.innerHTML = `<strong>${index + 1}. ${task.name}</strong> (Priority: ${task.priorityScore})
            <br>
            <label>Due Date & Time:
                <input type="datetime-local" id="dueTask${task.index}" value="${task.dueDate}">
            </label>
            <br>
            <label>Best time to complete: ${task.bestTime}</label>
            <br>
            <label>Estimated Duration: ${task.duration} minutes</label>`;

        // Add automation or delegation warning
        if (task.automation === -1) {
            taskItem.innerHTML += `<br><span style="color: red;">‚ö†Ô∏è Consider automating this task!</span>`;
        }
        if (task.ownership === 1) {
            taskItem.innerHTML += `<br><span style="color: orange;">üîÑ Consider delegating this task.</span>`;
        }

        taskList.appendChild(taskItem);
    });
}
